

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Generate model parameters input file &mdash; toughio 1.4.4 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Import and visualize simulation outputs in PyVista" href="4_import_and_visualize_simulation_outputs_in_pyvista.html" />
    <link rel="prev" title="Generate MESH and INCON files" href="2_generate_mesh_and_incon_files.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> toughio
          

          
          </a>

          
            
            
              <div class="version">
                1.4.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../gallery/index.html">Gallery</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">CO<sub>2</sub> leakage along a fault</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1_generate_mesh_in_python_with_gmsh.html">Generate mesh in Python with Gmsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="2_generate_mesh_and_incon_files.html">Generate MESH and INCON files</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Generate model parameters input file</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_import_and_visualize_simulation_outputs_in_pyvista.html">Import and visualize simulation outputs in PyVista</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">toughio</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../gallery/index.html">Gallery</a> &raquo;</li>
        
          <li><a href="index.html">CO<sub>2</sub> leakage along a fault</a> &raquo;</li>
        
      <li>Generate model parameters input file</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/examples/co2_leakage_along_a_fault/3_generate_model_parameters_input_file.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-co2-leakage-along-a-fault-3-generate-model-parameters-input-file-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="generate-model-parameters-input-file">
<span id="sphx-glr-examples-co2-leakage-along-a-fault-3-generate-model-parameters-input-file-py"></span><h1>Generate model parameters input file<a class="headerlink" href="#generate-model-parameters-input-file" title="Permalink to this headline">¶</a></h1>
<p>Now that the mesh has been pre-processed, we can define the TOUGH simulation parameters.</p>
<p>As always, we first import the required modules for this example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">toughio</span>
</pre></div>
</div>
<p>A <code class="xref py py-mod docutils literal notranslate"><span class="pre">toughio</span></code> input file is defined as a nested dictionary with meaningful keywords.
Let’s initialize our parameter dictionary by giving the simulation a title and defining the equation-of-state. This example will also be run isothermally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Simulation of CO2 leak along a fault&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eos&quot;</span><span class="p">:</span> <span class="s2">&quot;eco2n&quot;</span><span class="p">,</span>
    <span class="s2">&quot;isothermal&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can also define some default values that are shared by the different materials.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="mf">2260.0</span><span class="p">,</span>
    <span class="s2">&quot;conductivity&quot;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">,</span>
    <span class="s2">&quot;specific_heat&quot;</span><span class="p">:</span> <span class="mf">1500.0</span><span class="p">,</span>
    <span class="s2">&quot;compressibility&quot;</span><span class="p">:</span> <span class="mf">8.33e-10</span><span class="p">,</span>
    <span class="s2">&quot;conductivity_dry&quot;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">,</span>
    <span class="s2">&quot;tortuosity&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="s2">&quot;relative_permeability&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="s2">&quot;capillarity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.457</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.03e-5</span><span class="p">,</span> <span class="mf">5.0e7</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, we define specific material properties (different than the default ones previously defined) for each material in the mesh (i.e. we write the block <cite>ROCKS</cite>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;rocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;UPPAQ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;porosity&quot;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
        <span class="s2">&quot;permeability&quot;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CENAQ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;porosity&quot;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
        <span class="s2">&quot;permeability&quot;</span><span class="p">:</span> <span class="mf">1.0e-13</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;BASAQ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;porosity&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">&quot;permeability&quot;</span><span class="p">:</span> <span class="mf">1.0e-16</span><span class="p">,</span>
        <span class="s2">&quot;relative_permeability&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s2">&quot;capillarity&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.457</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.61e-6</span><span class="p">,</span> <span class="mf">5.0e7</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;CAPRO&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;porosity&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">&quot;permeability&quot;</span><span class="p">:</span> <span class="mf">1.0e-19</span><span class="p">,</span>
        <span class="s2">&quot;relative_permeability&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s2">&quot;capillarity&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.457</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.61e-6</span><span class="p">,</span> <span class="mf">5.0e7</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;FAULT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;porosity&quot;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
        <span class="s2">&quot;permeability&quot;</span><span class="p">:</span> <span class="mf">1.0e-13</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;BOUND&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;specific_heat&quot;</span><span class="p">:</span> <span class="mf">1.0e55</span><span class="p">,</span>
        <span class="s2">&quot;porosity&quot;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
        <span class="s2">&quot;permeability&quot;</span><span class="p">:</span> <span class="mf">1.0e-13</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can specify some simulation parameters (block <cite>PARAM</cite>), options (<cite>MOP</cite>) and selections (block <cite>SELEC</cite>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_cycle&quot;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
    <span class="s2">&quot;n_cycle_print&quot;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
    <span class="s2">&quot;t_ini&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;t_max&quot;</span><span class="p">:</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="mf">24.0</span> <span class="o">*</span> <span class="mf">3600.0</span><span class="p">,</span>
    <span class="s2">&quot;t_steps&quot;</span><span class="p">:</span> <span class="mf">24.0</span> <span class="o">*</span> <span class="mf">3600.0</span><span class="p">,</span>
    <span class="s2">&quot;t_step_max&quot;</span><span class="p">:</span> <span class="mf">1.0e8</span><span class="p">,</span>
    <span class="s2">&quot;t_reduce_factor&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;eps1&quot;</span><span class="p">:</span> <span class="mf">1.0e-4</span><span class="p">,</span>
    <span class="s2">&quot;eps2&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s2">&quot;gravity&quot;</span><span class="p">:</span> <span class="mf">9.81</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;extra_options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">16</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;selections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;integers&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="mi">13</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="mi">16</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;floats&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We also have to define the generator (i.e. the source).
However, we first need to know the name of the cell in which the CO2 is injected. Let’s unpickle the mesh back and use the method <a class="reference internal" href="../../api/mesh.html#toughio.Mesh.near" title="toughio.Mesh.near"><code class="xref py py-meth docutils literal notranslate"><span class="pre">toughio.Mesh.near()</span></code></a> to get the name of the injection element.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">toughio</span><span class="o">.</span><span class="n">read_mesh</span><span class="p">(</span><span class="s2">&quot;mesh.pickle&quot;</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">mesh</span><span class="o">.</span><span class="n">near</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1500.0</span><span class="p">))]</span>
</pre></div>
</div>
<p>Now we can add the generator to the parameters by specifying the type and injection rate (block <cite>GENER</cite>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">label</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;COM3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rates&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let’s customize the outputs.
For this example, we want TOUGH to save the output every three months (i.e. 4 outputs per year). To reduce the size of the output file, we also want TOUGH to only save the saturation of phase 1 (gas) in addition to the cell coordinates. Note that this option is only available in TOUGH3.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;times&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="o">*</span> <span class="mf">90.0</span> <span class="o">*</span> <span class="mf">24.0</span> <span class="o">*</span> <span class="mf">3600.0</span>
<span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;saturation&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;coordinate&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, we can export the model parameters input file by using the function <a class="reference internal" href="../../api/io.html#toughio.write_input" title="toughio.write_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">toughio.write_input()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">toughio</span><span class="o">.</span><span class="n">write_input</span><span class="p">(</span><span class="s2">&quot;INFILE&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
<p>At this stage, all the input files required to run the simulation have been generated. We can now simply call TOUGH using EOS ECO2n (e.g. <code class="code docutils literal notranslate"><span class="pre">tough3-eco2n</span></code> for TOUGH3).</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.027 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-co2-leakage-along-a-fault-3-generate-model-parameters-input-file-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4a480a3f9ba6351dcf5758c90be7ab61/3_generate_model_parameters_input_file.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">3_generate_model_parameters_input_file.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4790b1dc53fd45ecd00f717e3df347da/3_generate_model_parameters_input_file.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">3_generate_model_parameters_input_file.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="4_import_and_visualize_simulation_outputs_in_pyvista.html" class="btn btn-neutral float-right" title="Import and visualize simulation outputs in PyVista" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="2_generate_mesh_and_incon_files.html" class="btn btn-neutral float-left" title="Generate MESH and INCON files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Keurfon Luu

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>